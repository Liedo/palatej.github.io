---
layout: left-menu
title: Cholette (SSF)
tagline: technical documentation for JDemetra+ using GitHub Pages
description: State space representation of the Cholette algorithm
order: 200
---

# State space form for the Cholette algorithm

### Introduction

Given an initial time series $z_t,\; 0 \le t < n$ we have to find the corresponding  $x_t$ that respects the (observed) aggregation constraints $\mathbf{x_T} =\sum_{t \in T}x_t$ and that follows the short-term movements of $z_t$.

In the Cholette's method, this is achieved by minimizing the following quadratic penalty function:

$$ \sum_t{\left( \frac{x_t-z_t}{\vert z_t \vert^\lambda}-\rho \frac{x_{t-1}-z_{t-1}}{\vert z_{t-1} \vert^\lambda} \right)^2} $$

It is easy to see that the quadratic function of Cholette corresponds, from a formal point of view, to the sum of the square residuals generated by the auto-regressive process:

$$ \frac{x_t-z_t}{|z_t|^\lambda}=\frac{\delta_t}{\vert z_t \vert ^\lambda}=\mu_t$$

$$ \mu_t = \rho \mu_{t-1} + \epsilon_t $$

To simplify the notations, we will use hereafter $\vert z_t \vert^\lambda=\gamma_t$ .

Starting from that observation, we can give the Cholette's algorithm a state space representation.


### State vector

We define the state vector as

$$ \alpha_t= \begin{pmatrix}  \left( \gamma_t \mu_t \right)^{\underline C} \\ \mu_t \end{pmatrix} $$


### Initialization 

$$ \alpha_{-1} = \begin{pmatrix}  0 \\ 0 \end{pmatrix} $$

#### Not diffuse: $rho<1$

$$ P_{*} = \begin{pmatrix}  0  & 0 \\ 0 & \frac{1}{1-\rho^2} \end{pmatrix} $$

#### Diffuse (Denton variant): $\rho=1$

$$ B = \begin{pmatrix}  0 \\ 1 \end{pmatrix} $$
<br>

$$ P_{\infty} = \begin{pmatrix}  0 & 0 \\ 0 & 1 \end{pmatrix} $$
### Dynamics 

$$ T_t = \begin{cases} \begin{pmatrix}0 &0  \\0&\rho \end{pmatrix},& {t+1} \mod {c} = 0\\ \begin{pmatrix} 0 & \gamma_t\\ 0 & \rho\end{pmatrix},& {t} \mod {c} = 0\\\begin{pmatrix} 1 & \gamma_t\\ 0 & \rho\end{pmatrix},&  otherwise\end{cases}$$
<br>

$$ V_t = \begin{pmatrix}0 &0  \\0&1 \end{pmatrix} ,\quad S_t = \begin{pmatrix}0 \\ 1 \end{pmatrix} $$

### Measurement

$$ Z_t = \begin{cases} \begin{pmatrix} 0 & \gamma_t\end{pmatrix},& {t} \mod {c} = 0 \\ \begin{pmatrix} 1 & \gamma_t \end{pmatrix},& {t} \mod {c} \neq 0\end{cases}$$
<br>

$$ h_t = 0 $$

The "observations" are defined by $Z_t \alpha_t=\left(\gamma_t \mu_t \right)^C$. They are available for the periods $t$ such that $t=q c-1$ and missing for the other periods. For the observed periods, they correspond to $\mathbf{x_T}-\mathbf{z_T}$.

Once $\hat\mu_t$ have been estimated, we retrieve $\hat x_t$ by $\hat x_t=z_t+\gamma_t\hat\mu_t$

